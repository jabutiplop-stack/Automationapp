<h1 class="h2"><%= title %></h1>

<div class="card">
  <div class="card__body">
    <div class="table-wrap">
      <table class="table">
        <thead>
          <tr><th>ID</th><th>Login</th><th>Uprawnienia</th><th>Akcje</th></tr>
        </thead>
        <tbody>
          <% users.forEach(u => { %>
            <tr>
              <td><%= u.id %></td>
              <td><%= u.username %></td>
              <td><%= (u.permissions || []).join(', ') || '-' %></td>
              <td>
                <form method="POST" action="/admin/users/<%= u.id %>/permissions">
                    <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
                  
                    <% [
                      'social:v1',
                      'social:v2',
                      'social:v3',
                      'users:manage' // dostęp do panelu Użytkownicy
                    ].forEach(p => { %>
                      <label style="margin-right:12px; display:inline-block;">
                        <input type="checkbox" name="permissions" value="<%= p %>"
                          <%= (u.permissions || []).includes(p) ? 'checked' : '' %> />
                        <span class="muted"><%= p %></span>
                      </label>
                    <% }) %>
                  
                    <button class="btn btn--sm" type="submit">Zapisz</button>
                  </form>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  </div>
</div>